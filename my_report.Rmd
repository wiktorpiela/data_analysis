---
title: "Google Play store - exploration"
author: "Wiktor Piela"
date: "17 01 2021"
output:
  html_document:
    theme: cosmo
    toc: yes
    toc_float: yes
  pdf_document:
    toc: yes
  word_document:
    toc: yes
editor_options:
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  warning = FALSE,
  error = FALSE,
  message = FALSE,
  fig.align = "center",
  out.width = "70%",
  fig.width = 6,
  fig.asp = 0.618)
library("tidyverse")
library("lubridate")
library("ggplot2")
library("skimr")
library("descr")
library("scales")
library("viridis")
library("ggthemr")
library("mosaic")
library("knitr")
library("kableExtra")
ggthemr("fresh")
```
## Data importing and preparing

This dataset contains information about the applications included in google play store between 2010 and 2018. The analysis purpose to explore the content of the collection in order to find interesting relationships between variables and present the more or less prepared information in graphs.

First task that we need to complete is import data into R environment and clear the data where it is necessary. Have a look at below action:

I use glimpse function to check how this dataset looks like in general: columns, datatypes, first variables and dimensions of tibble and of course if any error occurred. I am checking and judging on which variables will be useful for analysis, which I can remove, which I need to change.

```{r data importing, include = TRUE}
play <- read_csv("data/googleplaystore.csv")

glimpse(play)
```

First thing that I want to change is removal dollar sign $ from column Price to make possible change datatype of this variable from character to double. And second action - using *lubridate* package - I change datatype of Last Updated from character to date, because later I am going to work on this variable as date a lot of times.

``` {r data cleaning_price table, echo = FALSE}
count(play, Price) %>%  #counting to control
  mutate(count = sum(n)) 
```
```{r data cleaning_price}
play <- play %>% 
  mutate(Price = as.numeric(str_remove(Price, "[$]"))) %>%  #also str_replace_all()
  replace_na(list(Price = 0)) %>% #Everynone -> NA -> 0
  mutate(`Last Updated` = mdy(`Last Updated`))
```

Now, as you can see, column Size contains also character variables, but I would expect here numeric datatype - that's why first of all I have to distinguish kb from Mb, remove some characters  to switch to a common unit - I have chosen Mb. In this step I lost some of data, because some of variables have "Varies with device" instead of specific values.

```{r data clearing_units table before, echo = FALSE}
count(play, Size) %>% 
  mutate(count = sum(n))
```
```{r data clearing_units}
play <- play %>% 
  mutate(kb = ifelse(str_detect(Size, "k"), Size, 0),
         Mb = ifelse(str_detect(Size, "M"), Size, 0)) %>% 
  mutate(kb = as.numeric(str_remove(kb, "k")),
         Mb = as.numeric(str_remove(Mb, "M"))) %>% 
  mutate(kb = kb / 1024,
         actual_size = kb + Mb) #Varies with device -> 0
```
```{r data clearing_units table after, echo = FALSE}
count(play, actual_size) %>% 
  mutate(count = sum(n))
```

Column Content Rating includes target groups of given apps. here I modified the data labels and standardize them in following way and at the same time I renamed the column label.

``` {r data clearing_groups table before, echo = FALSE}
count(play, `Content Rating`) %>% 
  mutate(count = sum(n))
```
```{r data clearing_groups}
play <- play %>% 
  rename("Group" = `Content Rating`) %>% 
  mutate(Group = fct_collapse(Group,
                              Adults = c("Adults only 18+", "Mature 17+"),
                              Teen = c("Teen", "Everyone 10+"),
                              Everyone = c("Everyone","Unrated")))
```
```{r data clearing_groups table after, echo = FALSE}
count(play, Group) %>% 
  mutate(count = sum(n))
```

From Installs variable I need to delete characters like plus and comma signs
to make possible change default datatype to numeric. Removal of comma sign was especially harder, because of it is special character in R environment. 

``` {r data clearing_installs table before, echo = FALSE}
#data clearing - Istalls variable - plus sing and , character removal
count(play, Installs) %>% 
  mutate(count = sum(n))
```
```{r data clearing_installs}
play <- play %>% 
  mutate(Installs = str_remove(Installs, "[+]"),
         Installs = as.numeric(str_remove(Installs, "[/,]")))
```

The last step that I would like to do preparing tibble content for further analysis is organizing the columns and finally removing useless ones. And of course preventative I converted datatypes of remaining character variables into factors.

``` {r data clearing_cleanup_columns, include - TRUE}
play <- play %>% 
  select(App, Category, Rating, Reviews, Installs, Type, Price,
         Group, `Last Updated`, actual_size) %>% 
  mutate(Category = as.factor(Category),
         Type = as.factor(Type),
         Group = as.factor(Group))
```
```{r data gplimpse after manipulation, echo = FALSE}
glimpse(play)
```

## Basic information extracting

The first thing that came to my mind thinking about dataset of google play content is how many paid and free apps we have, let's see that. Below pie chart presents that clear. 

```{r pie_chart paid vs free apps, echo = FALSE}
play %>% 
  filter(Type %in% c("Paid", "Free")) %>% 
  ggplot(aes("", fill = Type))+
  geom_bar(position = "fill")+
  coord_polar(theta = "y")+
  scale_y_continuous(labels = percent, breaks = seq(0, 1, 0.15))+
  labs(title = "Share of both type of applications in the set",
       x = "Applications", y = "Share in percent")+
  theme(axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        axis.ticks  = element_blank())
```
```{r paid vs free apps data labels, echo = FALSE}
play %>% 
  filter(Type %in% c("Paid", "Free")) %>%
  count(Type) %>% 
  mutate(share = n / sum(n) * 100) %>% 
  kable(caption = "Data labels") %>% 
  kable_styling(full_width = FALSE) %>% 
  column_spec(1, bold = TRUE, border_right = TRUE) %>% 
  column_spec(2, width = "6em", background = "grey") %>% 
  column_spec(3, background = "grey")
```

Paid apps are about 7.4% - it is less than we likely expected, but in my opinion enough amount to compare paid and free apps later through other variables.

Later, I would like to present how it looks like through time range 2010-2018. Paid apps have been registered only since 2011. Please be aware that y axis was presented using logarithmic scale. There wasn't such a moment in the entire period under study so that the number of paid apps was greater than the free ones, the difference is large and is constantly growing, especially visible since 2014. However, both types still keep increasing in absolute amount.
```{r smooth_plot_range_time, echo = FALSE}
play %>% 
  filter(Type %in% c("Paid", "Free")) %>% 
  mutate(year = year(`Last Updated`)) %>% 
  group_by(year) %>% 
  count(Type) %>% 
  ggplot(aes(year, n, col = Type))+
  geom_smooth(se = FALSE)+
  scale_y_log10()+
  labs(y = "Real amount of apps aggregated by year",
       x = "Years",
       title = "Yearly depiction of growing amount both types of apps")+ 
  scale_color_manual(values = c("red", "blue"))
```
Although on above plot we saw increasing amount of both paid and free ones, proportionally it looks preety different. Here is visible decreasing of paid apps (showing proportionally). Visibly, after 2014 paid ones have been losing successive on apps market. Likely, it is due to increasing competition from free apps side, free equivalent, etc. 
```{r proportionally, echo = FALSE}
play %>% 
  filter(Type %in% c("Paid", "Free")) %>% 
  mutate(year = year(`Last Updated`)) %>% 
  group_by(year) %>% 
  count(Type) %>% 
  mutate(prop = n / sum(n) * 100) %>% 
  ggplot(aes(year, prop, col = Type))+
  geom_smooth(se = FALSE)+
  labs(y = "Apps proportion")+
  geom_hline(yintercept = 50, col = "red", size = 0.7)+
  annotate(geom = "label", x = 2013, y = 55, label = "Reference")+
  scale_color_manual(values = c("red", "blue"))
```
Another interesting information that we are able to extract from given dataset is week day of update release. There is visible relationship here - between week day and update release - in vain to expect any updates during the weekend.
```{r week day and release, echo = FALSE}
play %>% 
  filter(!is.na(`Last Updated`)) %>% 
  mutate(weekday = weekdays(`Last Updated`),
         weekday = as.factor(weekday)) %>% 
  ggplot(aes(fct_infreq(weekday))) +
  geom_bar()+
  geom_hline(yintercept = 1981, col = "red")+
  geom_hline(yintercept = 656, col = "red")+
  annotate(geom = "label", x = "piÄ…tek", y = 2010,
           label = "Maximum - Thursday 1981 releases")+
  annotate(geom = "label", x = "wtorek", y = 700,
           label = "Minimum - Sunday 656 releases")+
  labs(title = "The least amount of updates were released during the weekend",
       x = "Weekdays", y = "Absolute amount of updates")
```
And data labels for above:
```{r week day and release data labels, echo = FALSE}
play %>% 
  filter(!is.na(`Last Updated`)) %>% 
  mutate(weekday = weekdays(`Last Updated`)) %>%
  count(weekday) %>% 
  kable(caption = "Week days and last update - data labels") %>% 
  kable_styling(full_width = FALSE) %>% 
  column_spec(1, bold = TRUE, border_right = TRUE) %>%
  column_spec(2, width = "6em", background = "grey") 
```
Having precisely counted, how many updates were released on a given day of the week, let's consider the probability that a randomly selected application was last updated on freely chosen day of the week.
```{r probability weekday occurs, echo = FALSE}
col_week <- c("#e1d6b7","#afb5da","#b4cfab","#dcc9e2","#add9cd","#e3b1ac","#98d4e4")
play %>% 
  mutate(weekday = weekdays(`Last Updated`),
         weekday = as.factor(weekday)) %>% 
  filter(!is.na(weekday)) %>% 
  ggplot(aes("", fill = fct_infreq(weekday)))+
  geom_bar(position = "fill", width = 0.6)+
  scale_fill_manual(values = col_week)+
  scale_y_continuous(labels = percent, breaks = seq(0, 1, 0.1))+
  theme(axis.title = element_blank(),
        axis.ticks.x = element_blank())+
  labs(fill = "Weekday")
play %>% 
  mutate(weekday = weekdays(`Last Updated`)) %>% 
  filter(!is.na(weekday)) %>% 
  count(weekday, sort = TRUE) %>% 
  mutate(probability = n / sum(n) *100) %>% 
  kable(caption = "Weekday occurs probability - data labels") %>% 
  kable_styling(full_width = FALSE) %>% 
  column_spec(1, bold = TRUE, border_right = TRUE) %>%
  column_spec(2, width = "6em", background = "grey") %>% 
  column_spec(3, background = "grey")
```
But how would it look like if we only choose the most popular day for the updates (Thursday) and the least popular one (Sunday)? Have a look at distribution of probability:
```{r probability Thursday vs Sunday, echo = FALSE}
play %>% 
  mutate(weekday = weekdays(`Last Updated`)) %>% 
  filter(weekday %in% c("czwartek", "niedziela")) %>% 
  count(weekday, sort = TRUE) %>% 
  mutate(probability = n / sum(n) *100) %>% 
  ggplot(aes("Weekday", probability, fill = weekday))+
  geom_col(width = 0.6)+
  annotate(geom = "label", x = "Weekday", y = 10, label = "24.9%")+
  annotate(geom = "label", x = "Weekday", y = 75, label = "75.1%")+
  theme(axis.title.x = element_blank(),
        axis.ticks.x = element_blank())
```
Once we throw off other days, the probability that randomly chosen apps was updated on Thursday is more than 3/4, at the same time this is only less than 1/4 related to Sunday.

## Target groups analysis

As you remember, at the beginning, I standardized the names of target groups od applications and I corrected data labels which are untidy before. I did it because in this part I would like to present that and general and try to find any interesting relationship.

First of all let's see, how much target groups we have and how does the distribution look like. As expected, the most apps are dedicated for everyone, without age division. Next in order target groups are teens and then adults, who are also quite a large percentage compared to the general.
```{r target groups pie chart and data labels, echo = FALSE}
play %>% 
  filter(!is.na(Group)) %>% 
  ggplot(aes("", fill = Group))+
  geom_bar(position = "fill")+
  coord_polar(theta = "y")+
  scale_y_continuous(labels = percent, breaks = seq(0, 1, 0.15))+
  theme(axis.title = element_blank(),
        axis.ticks = element_blank(),
        axis.text.y = element_blank())
play %>% 
  filter(!is.na(Group)) %>% 
  count(Group) %>% 
  mutate(percent = n / sum(n) * 100) %>% 
  kable(caption = "Target groups counting - data labels") %>% 
  kable_styling(full_width = FALSE) %>% 
  column_spec(1, bold = TRUE, border_right = TRUE) %>%
  column_spec(2, width = "6em", background = "grey") %>% 
  column_spec(3, background = "grey")
```
At this stage, the natural question that we could ask is - what categories of the apps each groups prefer the most. This is an important question not only from an economic point of view and of course every young and ambitious developer of mobile apps might ask. Let's try to explore the set, count and answer the question. I selected 3 most popular category for each group - (proportions inside group, not in general).

*Assumptions*:

* for current analysis I took only 3 the most representative categories of apps for each groups

* on the charts I presented only those categories which have more than 10% share inside given group

```{r table counting categories by groups, echo = FALSE}
play %>% 
  filter(Group %in% c("Everyone", "Teen", "Adults")) %>% 
  group_by(Group) %>% 
  count(Category, sort = TRUE) %>% 
  mutate(prop = n / sum(n)* 100) %>% 
  group_by(Group) %>% 
  top_n(3, prop) %>% 
  arrange(Group, desc(prop)) %>% 
  kable(caption = "Popular categories by target groups") %>% 
  kable_styling(full_width = FALSE) %>% 
  column_spec(1, bold = TRUE, border_right = TRUE) %>%
  column_spec(2, width = "6em", background = "grey") %>% 
  column_spec(3, background = "grey") %>% 
  column_spec(4, background = "grey")
```
Let's put the data on the charts for adults group:
```{r chart adults category, echo = FALSE}
play %>% 
  filter(Group == "Adults") %>% 
  mutate(Category = fct_other(Category,
                              keep = c("DATING", "GAME", "SOCIAL"))) %>% 
  ggplot(aes(Group, fill = Category))+
  geom_bar(position = "fill", width = 0.6)+
  scale_y_continuous(labels = percent)+
  theme(axis.text.x = element_blank())+
  labs(y = "Proportion", 
       title = "Dating apps the most popular among adult users")+
  annotate(geom = "label", x = "Adults", y = 0.8, label = "40%")+
  annotate(geom = "label", x = "Adults", y = 0.5, label = "14.7%")+
  annotate(geom = "label", x = "Adults", y = 0.4, label = "13.3%")
play_groups_category_adults <- play %>% 
  filter(!is.na(Group)) %>% 
  mutate(Category = fct_other(Category,
                              keep = c("DATING", "GAME", "SOCIAL")))
```
*Significant insights*:

* group of adult users is dominated by only one category - dating apps make up 40% of all available categories dedicated for adults customers. Thanks to dating apps domination, adults are the least diversified of given group. The same or at least similar share doesn't exist in case of none of next clusters. Every remaining categories of apps (where none achieves more than 10% of general amount in group) it is only 32 percent. So, if some developers are looking for idea for apps for adult clients, the biggest oportunity to success would be if they start create dating, game or social networking apps

For teens:
```{r chart teens category, echo = FALSE}
play %>% 
  filter(Group == "Teen") %>% 
  mutate(Category = fct_other(Category,
                              keep = c("GAME", "FAMILY"))) %>% 
  ggplot(aes(Group, fill = fct_infreq(Category)))+
  geom_bar(position = "fill", width = 0.5)+
  scale_y_continuous(labels = percent)+
  theme(axis.text.x = element_blank(),
        axis.ticks.x = element_blank())+
  labs(y = "Proportion",
       title = "Teen's group more diversified",
       fill = "Category")+
  annotate(geom = "label", x = "Teen", y = 0.75, label = "47.3%")+
  annotate(geom = "label", x = "Teen", y = 0.45, label = "28.5%")+
  annotate(geom = "label", x = "Teen", y = 0.15, label = "24.2%")
```

*Significant insights*:

* the group of teen customers is more diversified than previous one - here we have only two categories that have more than 10% share - those are games and family apps (both with similar share). In sum, they have somewhat bigger share than 50%

And for everyone:
```{r chart everyone category, echo=FALSE}
play %>% 
  filter(Group == "Everyone") %>% 
  mutate(Category = fct_other(Category, 
                              keep = "FAMILY")) %>% 
  ggplot(aes(Group, fill = Category))+
  geom_bar(position = "fill", width = 0.5)+
  scale_y_continuous(labels = percent)+
  theme(axis.text.x = element_blank(),
        axis.ticks.x = element_blank())+
  annotate(geom = "label", x = "Everyone", y = 0.9, label = "17.6%")+
  labs(title = "Everyone's group the most diversified", y = "Proportion")
```
*Significant insights*:

* only one  kind of apps as a dominator- family apps in this case and aggregate category (82,4%) of other are doing group of everyone the most diversified if we compare with previous ones
 
It is existing one more variable that would be interesting among target groups which are being analyzing, namely before mentioned types of apps - paid and free one. I excluded Everyone group right here, because it is incomparably more numerous as first pie chart indicated on current chapter. 
```{r type of apps inside groups, echo = FALSE}
play %>% 
  filter(Reviews > 200, !is.na(Group), Type %in% c("Paid", "Free"), 
         Group != "Everyone") %>% 
  ggplot(aes(Type, fill = Group))+
  geom_bar(position = "fill")+
  scale_y_continuous(labels = percent)
play %>% 
  filter(Reviews > 200, Group %in% c("Adults", "Teen"), 
         Type %in% c("Paid", "Free")) %>% 
  group_by(Type, Group) %>% 
  count(Type) %>%
  group_by(Type) %>% 
  mutate(prop = n / sum(n) * 100) %>% 
  kable(caption = "Popular categories by target groups") %>% 
  kable_styling(full_width = FALSE) %>% 
  column_spec(1, bold = TRUE, border_right = TRUE) %>%
  column_spec(2, width = "6em", background = "grey") %>% 
  column_spec(3, background = "grey") %>% 
  column_spec(4, background = "grey")
```
**Insights**

* more than every eighth paid application belongs to teen group

* likely, it is because of game apps what is the most popular category among this cluster of clients, are paid or includes in-app purchase

* nonetheless, proportions in case of both types are very similar and comparable

That's why I present below chart- it shows the same case but on the contrary, there we can find the information how many paid or free apps are inside each of target group. Don't paying attention on scale, because it is logarithmic, we can see that among teen is more paid apps than in case of adults.
```{r on the contrary, echo=FALSE}
play %>% 
  filter(Type %in% c("Paid", "Free"),
         Reviews > 200,
         Group %in% c("Teen", "Adults")) %>% 
  ggplot(aes(Group, fill = Type))+
  geom_bar(position = "fill")+
  scale_y_log10()+
  theme(axis.title.y = element_blank(),
        axis.text.y = element_blank(),
        axis.ticks.y = element_blank())
```
To finally judge where is more paid app, for adults or teens, let me present below chart.
```{r only paid apps, echo=FALSE}
play %>% 
  filter(Type == "Paid",
         Reviews > 200,
         Group %in% c("Adults", "Teen")) %>% 
  ggplot(aes(Type, fill = Group))+
  geom_bar(position = "fill", width = 0.6)+
  scale_y_continuous(labels = percent, breaks = seq(0, 1, 0.1))+
  theme(axis.text.x = element_blank(),
        axis.ticks = element_blank(),
        axis.title.y = element_blank())
```
If we consider only adult and teen groups and only paid apps, there is probability of about 85% that randomly selected apps will be dedicated for teens.

## Categories analysis
At this moment it is worth to ask what category is the most numerous, included division by paid and free one as it was mentioned before. I assumed that representative will be two of the most popular categories by each type - curiously, for both type the best known are exactly the same kind of categories.
```{r categories paid and free, echo=FALSE}
play %>% 
  filter(Type %in% c("Paid", "Free"), Reviews > 200) %>% 
  group_by(Type) %>% 
  count(Category, sort = TRUE) %>% 
  group_by(Type) %>% 
  mutate(prop = n / sum(n) * 100) %>% 
  ungroup() %>% 
  top_n(4, prop) %>% 
  kable(caption = "Categories counting by types") %>% 
  kable_styling(full_width = FALSE) %>% 
  column_spec(1, bold = TRUE, border_right = TRUE) %>%
  column_spec(2, width = "6em", background = "grey") %>% 
  column_spec(3, background = "grey") %>%
  column_spec(4, background = "grey") 
play %>% 
  filter(Type %in% c("Free", "Paid"), Reviews > 200) %>% 
  mutate(Category = fct_other(Category, keep = c("FAMILY", "GAME"))) %>% 
  ggplot(aes("", fill = fct_infreq(Category)))+
  geom_bar(position = "fill")+
  coord_polar(theta = "y")+
  scale_y_continuous(labels = percent, breaks = seq(0, 1, 0.15))+
  labs(fill = "Category",
  title = "Share the most numerous categories aming free apps vs paid apps set")+
  theme(axis.ticks = element_blank())+
  facet_wrap(vars(Type))+
  theme(axis.title = element_blank())
```
But above data has been aggregated and chart takes all of the information from time range 2010-2018 in sum. Let's have a look at time range on the example the most popular categories.
```{r pop categories counting, echo=FALSE}
pop_categories <- play %>% 
  filter(Type %in% c("Paid", "Free")) %>% 
  group_by(Type) %>% 
  count(Category, sort = TRUE) %>% 
  mutate(prop = n / sum(n)* 100) %>% 
  top_n(3, prop)

kable(pop_categories,caption = "Categories selection") %>% 
  kable_styling(full_width = FALSE) %>% 
  column_spec(1, bold = TRUE, border_right = TRUE) %>%
  column_spec(2, width = "6em", background = "grey") %>% 
  column_spec(3, background = "grey") %>%
  column_spec(4, background = "grey")
```
So, as table indicated, I need to choose given categories for each types separately (because there are a bit different), in addition, for type paid 4 categories are to be selected because both games and personalization files have the same share inside paid type.
```{r free apps time range, echo = FALSE}
cols1 <- c("#ca6451","#85a247","#a16abc")
play %>% 
  filter(Category %in% pop_categories$Category, Reviews > 200) %>% 
  mutate(year = year(`Last Updated`)) %>% 
  group_by(year) %>% 
  count(Category) %>% 
  filter(Category %in% c("FAMILY", "GAME", "TOOLS")) %>% 
  ggplot(aes(year, n, col = Category))+
  geom_smooth(se = FALSE)+
  scale_y_log10()+
  labs(title = "Yearly growth of free apps of the most popular Categories",
       y = "Amount of apps by year")+
  scale_color_manual(values = cols1)

cols2 <- c("#3fadaf","#ca6451","#85a247","#a16abc")
play %>% 
  filter(Category %in% pop_categories$Category, Reviews > 200) %>% 
  mutate(year = year(`Last Updated`)) %>% 
  group_by(year, Type) %>% 
  count(Category) %>% 
  filter(Category %in% 
           c("FAMILY", "MEDICAL", "GAME", "PERSONALIZATION")) %>% 
  ggplot(aes(year, n, col = Category))+
  geom_smooth(se = FALSE)+
  scale_y_log10()+
  labs(title = "Yearly growth of paid apps of popular categories",
       y = "Amount of apps by year") + 
  scale_color_manual(values = cols2)
```
**Insights**

* although in case of both types the amount of apps given categories increases regularly year by year, dynamic of growth is quite different - have a look at paid apps and y axis - growth is smaller

* free apps growth is almost linearly, in case of paid apps more visible fluctuations than related to free ones (especially games and medical apps)

* family apps have the longest history, they are registered since 2010

* this chart gives us additional information, namely which category of app is more numerous as of specific time

* free apps growth is uniform (differences between amount of categories are not to big, what we can see in case of paid ones - difference of quantity family or game apps and medial and personalization seems to be significant)

## Pricing

Initial assumption - for analysis related to pricing I took only paid apps and  having more than 200 reviews. Thanks that I investigate inside set of the common apps and well-known. The limit over 200 reviews means that apps go through common circulation in google play and it represents opinion of the users. I have also noticed that skewness of price distribution seems to be pretty strong, that's why I use median instead of average measurement for price to show actual situation.
```{r price histogram, echo = FALSE}
```

Whether does price of app depend on the target group?
```{r density pricing groups, echo=FALSE}
col_density <- c("#7aa457","#a46cb7","#cb6a49")
play %>% 
  filter(Type == "Paid", !is.na(Group), Reviews > 200) %>% 
  ggplot(aes(Price, fill = Group))+
  geom_density(alpha = 0.7, adjust = 3)+
  scale_x_log10()+
  scale_fill_manual(values = col_density)
```
Density plot shows that the most expensive apps belong to Everyone group, about 150 USD and more, but between 10USD and 100USD, adult's apps dominate in this range of price. We can see also that Everyone group is the most diversified regarding to price than other ones. The set of Everyone seems to be the cheapest group, but there are also protruding items (more than 100USD).  

Box plot will show that in details.
```{r boxplot pricing groups, echo= FALSE}
play %>% 
  filter(Type == "Paid", !is.na(Group), Reviews > 200) %>% 
  ggplot(aes(Group, Price))+
  geom_boxplot(coef = 3)+
  scale_y_log10()
play %>% 
  filter(Reviews > 200, !is.na(Group), Type == "Paid") %>% 
  group_by(Group) %>% 
  summarise(median_Price = median(Price),
            max_Price = max(Price),
            count = n()) %>% 
  kable(caption = "Data labels - which group has the most expensive apps?") %>% 
  kable_styling(full_width = FALSE) %>% 
  column_spec(1, bold = TRUE, border_right = TRUE) %>%
  column_spec(2, width = "6em", background = "grey") %>% 
  column_spec(3, background = "grey") %>% 
  column_spec(4, background = "grey")
```
It confirms the initial insight which are coming from density plot interpretation. Among set of the common apps the most expensive are adults with median price 4.49, later teen apps - median 3.99 and at the end Everyone with median price 2.99 - even though for that category belongs expensive apps, but they aren't so much numerous. 

Ultimate conclusion can be distorted by the sample strength - Everyone's app is too much comparing with other groups. Let's have a look at only two smaller ones and judge definitely which group have more expensive apps dedicated.  
```{r adults vs teens plotting, echo= FALSE}
play %>% 
  filter(Group %in% c("Teen", "Adults"),
         Type == "Paid", Reviews > 200) %>% 
  ggplot(aes(Price, fill = Group))+
  geom_density(adjust = 3, alpha = 0.6)

play %>% 
  filter(Group %in% c("Teen", "Adults"),
         Type == "Paid", Reviews > 200) %>% 
  ggplot(aes(Group, Price))+
  geom_boxplot(coef = 3)

play %>% 
  filter(Group %in% c("Teen", "Adults"),
         Type == "Paid", Reviews > 200) %>%
  group_by(Group) %>% 
  summarise(median_Price = median(Price),
            max_Price = max(Price),
            count = n()) %>% 
  kable(caption = "Adults vs Teens - pricing") %>% 
  kable_styling(full_width = FALSE) %>% 
  column_spec(1, bold = TRUE, border_right = TRUE) %>%
  column_spec(2, width = "6em", background = "grey") %>% 
  column_spec(3, background = "grey") %>% 
  column_spec(4, background = "grey")
```
General insights didn't change but now we are able to see distribution clear and get additional info that we haven't noticed before. Admittedly adults has higher median price than Teen's group, but the second one has higher maximum price.

*Which target group has the most expensive apps dedicated?*

1. Adults
2. Teens
3. Everyone (general group)

**Which category of paid apps is the most expensive?**
Below I present table including basic information related to relationship between popular categories and their pricing.
```{r price vs category table, echo = FALSE}
play %>% 
  filter(Type == "Paid", Reviews > 200) %>% 
  group_by(Category) %>% 
  summarise(median_price = median(Price),
            max_price = max(Price),
            min_price = min(Price), count = n()) %>% 
  top_n(3, count) %>% 
  kable(caption = "Popular categories and their price") %>% 
  kable_styling(full_width = FALSE) %>% 
  column_spec(1, bold = TRUE, border_right = TRUE) %>%
  column_spec(2, width = "6em", background = "grey") %>% 
  column_spec(3, background = "grey") %>% 
  column_spec(4, background = "grey") %>% 
  column_spec(5, background = "grey")
```
Putting the information on the charts to visualize
```{r price vs category, plots, echo = FALSE}
play %>% 
  filter(Type == "Paid", Reviews > 200,
         Category %in% c("FAMILY", "GAME", "MEDICAL")) %>% 
  ggplot(aes(Price, fill = Category))+
  geom_density(adjust = 3, alpha = 0.7)+
  scale_x_log10()

play %>% 
  filter(Type == "Paid", Reviews > 200,
         Category %in% c("FAMILY", "GAME", "MEDICAL")) %>% 
  ggplot(aes(Category, Price))+
  geom_boxplot(coef = 5)+
  scale_y_log10()
```
The most expensive items, that we were able to notice before, belong to category of family, however medical apps characterize the highest median of price. Family and games has the same price median value of price, but we cannot say that both categories has similarly price distribution - games are visibly cheaper because of 1st quartile of price. Other statistical indicator I present on below table.
```{r favstats, echo=FALSE}
play %>% 
  filter(Type == "Paid", Reviews > 200) %>% 
  favstats(Price ~ Category , data =.) %>% 
  filter(Category %in% c("FAMILY", "GAME", "MEDICAL")) %>% 
  kable(caption = "Statistical summary of price matter") %>% 
  kable_styling(full_width = FALSE) %>% 
  column_spec(1, bold = TRUE, border_right = TRUE) %>%
  column_spec(2, width = "6em", background = "grey") %>% 
  column_spec(3, background = "grey") %>% 
  column_spec(4, background = "grey") %>% 
  column_spec(5, background = "grey") %>% 
  column_spec(6, background = "grey") %>% 
  column_spec(7, background = "grey") %>% 
  column_spec(8, background = "grey") %>% 
  column_spec(9, background = "grey") %>% 
  column_spec(10, background = "grey")
```

**How has been price run between 2010 and 2018?**
```{r price in time range, echo=FALSE}
play %>% 
  filter(Reviews > 200, Type == "Paid", Price > 1) %>% 
  ggplot(aes(`Last Updated`, Price))+
  geom_smooth(se = FALSE)+
  geom_hline(yintercept = 2.99, col = "red", size = 0.7)+
  labs(x = "Years", y = "Average Price", 
       title = "Increase after 2016 mainly driven by a couple of the most expensive
       apps over 100 USD")+
  theme(axis.ticks = element_blank()) +
  annotate(geom = "label", x = ymd("2013-09-23"), y = 10, label = "Median price")
```
The price value depends on proportion between free apps and paid ones on the market, free equivalents and finally on customers awareness. With time run, competition on the market from free applications increases, so before 2018 the price drops significantly. The sudden increase and peak in prices is due to several very expensive applications mentioned above.

Price tendency on time range having (customers included)
```{r time range price adults vs teens, echo=FALSE}
play %>% 
  filter(Type == "Paid", Reviews > 200, Group %in% c("Adults", "Teen")) %>%   mutate(year = year(`Last Updated`)) %>% 
  group_by(year, Group) %>% 
  summarise(price = median(Price)) %>% 
  ggplot(aes(year, price, col = Group))+
  geom_smooth(se = FALSE)+
  expand_limits(y = 0)+
  labs(x = "Year", y = "Median Price by year",
       title = "Apps for adults have been still noticed decreasing   tendency")+
  scale_color_manual(values = c("red", "blue"))
  
```
As I indicated on the on of above charts, apps dedicated for adults was basically more expensive than for teens, but on this time range we can see that it wasn't always like that - for example between late 2014 and half of 2016, apps for teens were more expensive. Notice that apps for the youngest customers have been registered in dataset since 2013 and for adults just one year later. At the edn of period being investigated adult's price decreases strongly, but for teens growth slowly. This tendency shows that later teens apps could be more expensive again, like in the past 2014-2016.

**Price in the time range and popular categories**
```{r price categroies time range, echo=FALSE}
play %>% 
  filter(Type == "Paid", Reviews > 200, 
         Category %in% c("FAMILY", "GAME", "MEDICAL")) %>%
  ggplot(aes(`Last Updated`, Price, col = Category))+
  geom_smooth(se = FALSE)+
  scale_y_log10()+
  labs(x = "Dates", title = "Medical apps with the strongest prices growth trend")+
  scale_color_manual(values = c("red", "lightblue", "darkgreen"))
```
It is clearly visible that the price of medical applications has been increased strongly - likely, due to the growing popularity of this category, more people pay attention on their health and it is common that they want to help yourself to take care using mobile apps. While the prices of games was dropping quite suddenly - many games are offered for free and even the paid versions are becoming more common. 

Below I show you general table related to price matter - there you are able to find yearly median price of each category and how old is given category as well - if somewhere *NA* symbol exists, this category hasn't been registered in dataset then.
```{r pricing general table, echo=FALSE}
play %>% 
  filter(Type == "Paid", Reviews > 200) %>%
  mutate(year = year(`Last Updated`)) %>% 
  group_by(year, Category) %>% 
  summarise(price = median(Price, na.rm = TRUE)) %>% 
  pivot_wider(names_from = year, values_from = price) %>% 
  kable(caption = "Price general table") %>% 
  kable_styling(full_width = FALSE) %>% 
  column_spec(1, bold = TRUE, border_right = TRUE) %>%
  column_spec(2, width = "6em", background = "grey") %>% 
  column_spec(3, background = "grey") %>% 
  column_spec(4, background = "grey") %>% 
  column_spec(5, background = "grey") %>% 
  column_spec(6, background = "grey") %>% 
  column_spec(7, background = "grey") %>% 
  column_spec(8, background = "grey") 
```

## Rating

**Do paid applications are  better rated than free ones?**
Assumption - I don't consider apps having less than 200 reviews and those with no data or wrong data in rating column included. I use median as statistical measure, because of skewness of rating distribution - the same reason as in case of price.
```{r paid vs free - rating, echo=FALSE}
play %>% 
  filter(Rating < 19, Reviews > 200, Type %in% c("Paid", "Free")) %>% 
  ggplot(aes(Rating, fill = Type))+
  geom_density(alpha = 0.7, adjust = 2)

play %>% 
  filter(Rating < 19, Reviews > 200, Type %in% c("Paid", "Free")) %>% 
  ggplot(aes(Type, Rating))+
  geom_boxplot(coef = 5)

play %>% 
  filter(Rating < 19, Reviews > 200, Type %in% c("Paid", "Free")) %>% 
  group_by(Type) %>% 
  summarise(median_rating = median(Rating),
            count = n()) %>% 
  mutate(prop = count / sum(count) * 100) %>% 
  kable(caption = "Counting items and data labels") %>% 
  kable_styling(full_width = FALSE) %>% 
  column_spec(1, bold = TRUE, border_right = TRUE) %>%
  column_spec(2, width = "6em", background = "grey") %>% 
  column_spec(3, background = "grey") %>% 
  column_spec(4, background = "grey")
```
Both density plot and box plot shows that paid app are better rated but with no too big  advantage over free ones - it is about 0.1 of different. It is worth to pay attention on  size of both types -  paid apps have less than 5% of the share (after mentioned assumtpions included). To summarize - paid apps are better rated basically not too much as expected.

**Time range**

How it looks like in time range, in specific periods? Was paid applications always better than free ones, in the past as well? 
```{r time range paid free rating, echo=FALSE}
play %>% 
  filter(Rating < 19, Reviews > 200, Type %in% c("Paid", "Free")) %>% 
  ggplot(aes(`Last Updated`, Rating, col = Type))+
  geom_smooth(se = FALSE)+
  labs(x = "Time", title = "Paid apps higher rated all the time")+
  theme(axis.ticks.x = element_blank()) +
  scale_color_manual(values = c("#d43f5c", "#4e95d3"))
  
```
Paid applications, as a younger category, were rated better than free items from the beginning of the analyzed period, also in the case of both types, the median of ratings was constantly increasing. The most interesting thing is that from about 2016, the rating of free applications began to grow more dynamically, which gradually reduces the difference. That's why we could expect in the upcoming future, free apps would be ahead of paid ones. Below I present table with data labels yearly aggregated.
```{r table paid free rating, echo=FALSE}
play %>%  
  filter(Rating < 4.5, Reviews > 200, Type %in% c("Paid", "Free")) %>% 
  mutate(year = year(`Last Updated`)) %>% 
  group_by(year, Type) %>% 
  summarise(median_rating = median(Rating)) %>% 
  filter(year > 2011) %>% 
  pivot_wider(names_from = Type, values_from = median_rating) %>% 
  mutate(difference = Paid - Free,
         test = ifelse(difference > 0, "Paid better", 
                       ifelse(difference == 0, "The same", "Free better"))) %>% 
  kable(caption = "Yearly median ratings and difference") %>% 
  kable_styling(full_width = FALSE) %>% 
  column_spec(1, bold = TRUE, border_right = TRUE) %>%
  column_spec(2, width = "6em", background = "grey") %>% 
  column_spec(3, background = "grey") %>% 
  column_spec(4, background = "grey") %>% 
  column_spec(5, background = "grey") 
```
On the chart, where I put real rating values of given type of apps, after 2018 difference amounts about 0.1, but if you have a look at the table with data labels where I aggregated median ratings by year, difference at the end is equal zero (it is less precisely method, however it presents existing tendency that free apps was becoming to be the same good rated such as paid ones). See, how advantage of paid apps in rating has been melted down through years.
```{r table paid free rating difference plotting, echo=FALSE}
play %>%  
  filter(Rating < 4.5, Reviews > 200, Type %in% c("Paid", "Free")) %>% 
  mutate(year = year(`Last Updated`)) %>% 
  group_by(year, Type) %>% 
  summarise(median_rating = median(Rating)) %>% 
  filter(year > 2011) %>% 
  pivot_wider(names_from = Type, values_from = median_rating) %>% 
  mutate(difference = Paid - Free) %>% 
  ggplot(aes(year, difference))+
  geom_smooth(se = FALSE) +
  scale_color_manual(values = c("#d43f5c", "#4e95d3"))
```
*To sum up:*

* in the past paid apps was better rated, difference seemed to be more significant and although it still remains, is not to big to just say that paid apps are definitely better than free ones

*presented plots at the beginning of current chapter showed in general that paid apps are better rated but it is due to bigger advantage of paid app taken from the past 

Let's consider the same matter but with category on the background - which categories of paid apps are better than the same but of free and on the contrary. 
```{r paid and free apps rating which are better, echo=FALSE}
rating_table <- play %>% 
  filter(Rating < 4.5, Reviews > 200, Type %in% c("Paid", "Free")) %>% 
  group_by(Category, Type) %>% 
  summarise(Rating = median(Rating),
            count_views= sum(Reviews),
            count = n()) %>% 
  mutate(prop = count / sum(count) * 100) %>% 
  filter(prop != 100)

rating_table %>% 
  select(Category, Type, Rating) %>% 
  pivot_wider(names_from = Type, values_from = Rating) %>% 
  mutate(difference = Paid - Free,
         test = ifelse(difference > 0, "Paid better",
                       ifelse(difference == 0, "the same rating", "Free better"))) %>% 
  arrange(desc(difference)) %>% 
  kable(caption = "Paid or free ones - is it worth that") %>% 
  kable_styling(full_width = FALSE) %>% 
  column_spec(1, bold = TRUE, border_right = TRUE) %>%
  column_spec(2, width = "6em", background = "grey") %>% 
  column_spec(3, background = "grey") %>% 
  column_spec(4, background = "grey") %>% 
  column_spec(5, background = "grey")
```
Paying attention on rating, the most profitable is to buy medical applications instead of install free ones, where the advantage over the free ones is the greatest and amounts to 0.25. But it is not worth to buy map and navigation applications and financial, communication or lifestyles ones, in these categories free applications are rated much better.

But above we didn't consider proportions of amount both types, so let's do the same but keeping in mind proportions - paid apps must be relatively most numerous compared to free ones first of all.
```{r paid and free apps rating  - proportions, echo=FALSE}
rating_table %>%   
  select(Category, Type, prop) %>% 
  pivot_wider(names_from = Type, values_from = prop) %>% 
  mutate(difference = Free - Paid) %>% 
  arrange(difference) %>% 
  kable(caption = "Share and difference in %") %>% 
  kable_styling(full_width = FALSE) %>% 
  column_spec(1, bold = TRUE, border_right = TRUE) %>%
  column_spec(2, width = "6em", background = "grey") %>% 
  column_spec(3, background = "grey") %>% 
  column_spec(4, background = "grey")
```
So if the share of medical and personalization applications is the largest, let's see how they are rated and put the results on the chart
```{r medial vs personalization, echo = FALSE}
rating_table %>% 
  filter(Category %in% c("MEDICAL", "PERSONALIZATION")) %>% 
  ggplot(aes(Category, Rating, fill = Type))+
  geom_col(position = "dodge2")
```

**Does popularity depend on rating?**
At first glance that answer the above question is YES, because regularly, customers are being decided, before they select something ultimately, checking rating of the app - it seems to be obvious, because it is rationally customer's behavior.
```{r populartity vs rating, echo=FALSE}
play %>% 
  filter(Rating < 4.5, Reviews > 200, Type %in% c("Paid", "Free")) %>% 
  ggplot(aes(Rating, Reviews, col = Type))+
  geom_smooth(se = FALSE)+
  scale_y_log10()+
  scale_color_manual(values = c("#d43f5c", "#4e95d3"))
```
As you can see, the expected relationship exists for both types, the higher rating trigger more reviews and therefore the greater the number of installations. However, in the case of the paid ones it increases linearly, while the free ones growth more dynamically. The question is the price - the regular user likes to install a well-rated application for free because nothing is lost on it.


## Sizing

**General assumptions:**

* because of strong skewness of actual_size distribution I use median as average measure 

* for current analysis I excluded items with no data or zero value assigned to variable actual_size that I have cleared and prepared for analysis at the beginning

* unit of apps sizing was standardized and based on Mb

The first question that we would like to ask is following -  was applications becoming more and more virtual memory demanding ?
```{r sizing time range, echo=FALSE}
play %>% 
  filter(actual_size > 0) %>% 
  mutate(year = year(`Last Updated`),
         month = month(`Last Updated`),
         period = myd(paste(month, year), truncated = 1)) %>% 
  group_by(period) %>% 
  summarise(size = median(actual_size)) %>% 
  ggplot(aes(period, size))+
  geom_smooth(se = FALSE)+
  expand_limits(y = 0)
```
As above chart confirmed - apps was requiring successive more virtual memory. This trend was growing from the beginning of investigating period, but over the years it became more and more dynamic. Next let's focus on common statistical indicators of dynamics to check in details this matter. 
I calculated median size by year, absolute growth with constant base, absolute growth with variable base and relative growth with constant base.
```{r statistical measure, echo = FALSE}
 growth <- play %>% 
  filter(actual_size > 1) %>% 
  mutate(year = year(`Last Updated`)) %>%
  group_by(year) %>% 
  summarise(size = median(actual_size))

difference <- diff(growth$size)
difference <- append(difference, 0, after = 0)

growth %>% 
  mutate(abs_growth_const = growth$size - growth$size[1],
         abs_growth_vrbl = difference,
         relative_growth_const = (growth$size - growth$size[1]) / growth$size[1] * 100) %>% 
  kable(caption = "Basic statistical dynamic's indicators") %>% 
  kable_styling(full_width = FALSE) %>% 
  column_spec(1, bold = TRUE, border_right = TRUE) %>%
  column_spec(2, width = "6em", background = "grey") %>% 
  column_spec(3, background = "grey") %>% 
  column_spec(4, background = "grey") %>% 
  column_spec(5, background = "grey") 
```
Relative dynamics plot by year
```{r dynamic plot by year, echo = FALSE}
growth %>% 
  mutate(abs_growth_const = growth$size - growth$size[1],
         abs_growth_vrbl = difference,
         relative_growth_const = (growth$size - growth$size[1]) / growth$size[1]) %>% 
  ggplot(aes(year, relative_growth_const))+
  geom_point()+
  geom_line()+
  scale_y_continuous(labels = percent)+
  labs(x = "Years",
       y = "Increase in percents - dynamic",
       title = "Dynamics of apps sizing growth (in Mb) by year, 2011 = 100")
```
2018 apps required an average of more than 4 times more virtual memory than 2011. 

And below - how does distribution of other indicator look on time range being researched.
```{r other indicators on time range, echo = FALSE}
growth %>% 
  mutate(abs_growth_const = growth$size - growth$size[1],
         abs_growth_vrbl = difference,
         relative_growth_const = (growth$size - growth$size[1]) / growth$size[1] * 100) %>% 
  pivot_longer(cols = 3:5, names_to = "indicator", values_to = "value") %>% 
  ggplot(aes(year, value, col = indicator))+
  geom_smooth(se = FALSE)+
  facet_wrap(vars(indicator), scales = "free")+
  scale_color_manual(values = c("#c36785","#9f9244","#7f64b9"))+
  theme(legend.position = "none")
```
All of indicators measure the same, but differ in their sensitivity to change. 

**Which type of apps requires more virtual space on device? Does it depend on type if app is paid or free?**

For answer this question, I present on charts below.

```{r type and sizing, charts, echo= FALSE}
play %>% 
  filter(Type %in% c("Paid", "Free"),
         Reviews > 200, actual_size > 1) %>% 
  ggplot(aes(actual_size, fill = Type))+
  geom_density(alpha = 0.7)
#boxplot
play %>% 
  filter(Type %in% c("Paid", "Free"),
         Reviews > 200, actual_size > 1) %>% 
  ggplot(aes(Type, actual_size))+
  geom_boxplot(coef = 4)
```
By charts, it seems to be no relationship between type and size of the apps. To confirm, have a look at the table where you can find basic statistical ratios:
```{r type and sizing table, echo = FALSE}
play %>% 
  filter(Reviews > 200, actual_size > 1) %>% 
  favstats(actual_size ~ Type, data = .) %>% 
  filter(Type %in% c("Paid", "Free")) %>% 
  kable(caption = "Basic statistical indicators") %>% 
  kable_styling(full_width = FALSE) %>% 
  column_spec(1, bold = TRUE, border_right = TRUE) %>%
  column_spec(2, width = "6em", background = "grey") %>% 
  column_spec(3, background = "grey") %>% 
  column_spec(4, background = "grey") %>% 
  column_spec(5, background = "grey") %>% 
  column_spec(6, background = "grey") %>% 
  column_spec(7, background = "grey") %>% 
  column_spec(8, background = "grey") %>% 
  column_spec(9, background = "grey") %>% 
  column_spec(10, background = "grey")
```
As you can see, by median value, there is no significant relationship between sizing and type on the apps.

What about target groups? Let's check if there any relationships exists.
```{r sizing target groups, echo = FALSE}
play %>% 
  filter(Reviews > 200, actual_size > 1) %>% 
  ggplot(aes(actual_size, fill = Group))+
  geom_density(alpha = 0.6)

play %>% 
  filter(Reviews > 200, actual_size > 1) %>% 
  ggplot(aes(Group, actual_size))+
  geom_boxplot(coef = 3)

play %>% 
  filter(Reviews > 200, actual_size > 1) %>% 
  favstats(actual_size ~ Group, data = .) %>% 
  kable(caption = "Basic statistical indicators") %>% 
  kable_styling(full_width = FALSE) %>% 
  column_spec(1, bold = TRUE, border_right = TRUE) %>%
  column_spec(2, width = "6em", background = "grey") %>% 
  column_spec(3, background = "grey") %>% 
  column_spec(4, background = "grey") %>% 
  column_spec(5, background = "grey") %>% 
  column_spec(6, background = "grey") %>% 
  column_spec(7, background = "grey") %>% 
  column_spec(8, background = "grey") %>% 
  column_spec(9, background = "grey") %>% 
  column_spec(10, background = "grey")
```
We are able to see visible relationship right here - applications for the youngest customers require the most space in mobile devices. As you might remember, the most numerous category among young people are games, and they usually take the most virtual storage.

To confirm above let's have a look how much virtual memory do popular categories require.
```{r categories sizing, echo=FALSE}
play %>% 
  filter(Reviews > 200, actual_size > 1) %>% 
  count(Category, sort = TRUE) %>% 
  mutate(prop = n / sum(n) * 100) %>% #FAMILY GAME TOOLS
  top_n(3, prop) %>% 
  kable(caption = "Selecting categories") %>% 
  kable_styling(full_width = FALSE) %>% 
  column_spec(1, bold = TRUE, border_right = TRUE) %>%
  column_spec(2, width = "6em", background = "grey") %>% 
  column_spec(3, background = "grey")

play %>% 
  filter(Reviews > 200, actual_size > 1, 
         Category %in% c("FAMILY", "GAME", "TOOLS")) %>%
  ggplot(aes(actual_size, fill = Category))+
  geom_density(alpha = 0.6)

#boxplot
play %>% 
  filter(Reviews > 200, actual_size > 1, 
         Category %in% c("FAMILY", "GAME", "TOOLS")) %>% 
  ggplot(aes(Category, actual_size)) +
  geom_boxplot(coef = 3)

#data labels
play %>% 
  filter(Reviews > 200, actual_size > 1) %>% 
  favstats(actual_size ~ Category, data = .) %>% 
  filter(Category %in% c("FAMILY", "GAME", "TOOLS")) %>% 
  kable(caption = "Basic statistical indicators") %>% 
  kable_styling(full_width = FALSE) %>% 
  column_spec(1, bold = TRUE, border_right = TRUE) %>%
  column_spec(2, width = "6em", background = "grey") %>% 
  column_spec(3, background = "grey") %>% 
  column_spec(4, background = "grey") %>% 
  column_spec(5, background = "grey") %>% 
  column_spec(6, background = "grey") %>% 
  column_spec(7, background = "grey") %>% 
  column_spec(8, background = "grey") %>% 
  column_spec(9, background = "grey") %>% 
  column_spec(10, background = "grey")
```
Here the relationship is also very visible (because of obvious technical conditions), moreover, the hypothesis about games is also confirmed, they take the most places, so the group of young people clearly stands out from the rest when it comes to hardware requirements.
  

  



